<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Buscador de Iniciativas del Pleno de Alicante</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <h1>Buscador de Iniciativas del Pleno de Alicante <img src="https://upload.wikimedia.org/wikipedia/en/9/9a/Flag_of_Spain.svg" alt="Bandera de España" class="bandera"></h1>
    </header>
    <main>
        <form method="get">
            <select name="grupo" id="grupo" onchange="toggleConcejal()">
                <option value="">-- Grupo político --</option>
                {% for g in grupos %}
                <option value="{{ g }}" {% if g == grupo %}selected{% endif %}>{{ g }}</option>
                {% endfor %}
            </select>

            <input type="text" name="palabra_clave" placeholder="Palabra clave en el título" value="{{ palabra_clave }}">

            <select name="resultado">
                <option value="">-- Resultado --</option>
                {% for r in resultados_filtro %}
                <option value="{{ r }}" {% if r == resultado %}selected{% endif %}>{{ r }}</option>
                {% endfor %}
            </select>

            <select name="fecha">
                <option value="">-- Fecha del Pleno --</option>
                {% for f in fechas %}
                <option value="{{ f }}" {% if f == fecha %}selected{% endif %}>{{ f }}</option>
                {% endfor %}
            </select>

            <select name="concejal" id="concejal" style="display:none;">
                {% for c in concejales %}
                <option value="{{ c }}" {% if c == concejal %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>

            <button type="submit">Buscar</button>
        </form>

        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Grupo</th>
                    <th>Contenido</th>
                    <th>Resultado</th>
                    <th>Concejal</th>
                </tr>
            </thead>
            <tbody>
                {% for r in resultados %}
                <tr>
                    <td>{{ r["fecha"] }}</td>
                    <td>{{ r["grupo"] }}</td>
                    <td class="contenido">{{ r["contenido"] }}</td>
                    <td>{{ r["resultado"] }}</td>
                    <td>{{ r["concejal"] or '' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </main>

    <script>
        function toggleConcejal() {
            const grupo = document.getElementById("grupo").value;
            const concejalSelect = document.getElementById("concejal");
            concejalSelect.style.display = (grupo === "VOX") ? "inline-block" : "none";
        }
        window.onload = toggleConcejal;
    </script>
</body>
</html>
